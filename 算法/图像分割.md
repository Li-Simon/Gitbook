# 图像分割

1. 边缘检测
2. 霍夫变换
3. 阈值分割
4. 区域分割

边缘检测前面已经讨论过了，因此我们主要讨论下面三个话题。

## 霍夫变换

对于线条检测而言，霍夫变换不是在图像中直接检测某种类型的线条\(比如直线或者圆\)，它是在决定这些线条的参数空间\(比如直线就是斜率与截距，二维的圆对应的就是三个参数，圆心与半径\)去做符合特定线条的线条个数，把参数空间划分为方格，统计方格中符合条件的个数，也就是生成以恶累加器数组，也称为霍夫变换矩阵。有一点要注意的是，霍夫变换只能处理二值图像。因此一般先要把图像通过阈值方法变成二值图像。    

### 直线检测

我们把直线表示成如下的形式：  
  $$\rho = x\cos\theta + y\sin \theta$$  
因此参数空间就是$$(\rho, \theta)$$。

![](/assets/Hough_trans.png)  
图a是在原始空间的两点，图b是在参数空间，两条曲线分别所有过i,j两点的所有参数形成的曲线，i,j有一个交点，该点对应的就是过i,j两点的直线的参数。图c就是统计不同的参数区域块内的点数目，点的数目就是原始图像中任何两点形成的线条的参数是否落在该参数区域内，再就加1。这个参数累加器数组就是霍夫变换矩阵。  
具体步骤就是，对于原始图像空间的每一个非0点，我们在参数空间画出所有过该点所形成的曲线，比如$$\theta$$每隔一度去做一条直线，因此，每点我们需要做180条直线，在参数空间就是180个点。然后得到霍夫变换矩阵。矩阵中的亮点就是直线。

### 其它曲线

我们可以用霍夫变换来检测任何曲线，只要该曲线可以用参数来描述，假设参数的维数是n维，也就是需要n个参数来描述该曲线\(比如二维直线n=2,二维圆n=3\),因此霍夫变换矩阵的参数维度也就是n维，每一维采样点固定为S，则对于原始图像空间的每个点，在参数空间需要取$$S^n$$个点，因此随着n的增大会发生维度灾难。  
如下是用Hough变换来寻找半径已知的圆，也就是寻找过原始图像中一点的半径R一定的所有圆，这些所有的圆的参数，在参数空间也就是一个圆，这个圆就是以该点为圆心，做半径w为R的圆。在参数空间通过霍夫变换矩阵：  
![](/assets/Hough_Cycle.png)

## 阈值分割[^1]

### 全阈值分割

全阈值分割指的是将灰度值大于阈值threshold的像素设为白色，小于或者等于阈值的像素设为黑色。  
  $$O(x,y) = 255$$.  if  $$I(x,y) > thresh$$  
  $$O(x,y) = 0$$.  if  $$I(x,y) \le thresh$$

### 局部阈值分割

不像全阈值分割中阈值在整个图像区域是个常数，在局部阈值分割中，阈值是位置的函数，也是一个与图像一样大小的矩阵。此时有：  
  $$O(x,y) = 255$$.  if  $$I(x,y) > thresh(x,y)$$  
  $$O(x,y) = 0$$.  if  $$I(x,y) \le thresh(x,y)$$  
局部阈值分割的核心是计算阈值矩阵，比较常用的是自适应阈值算法\(又称为移动平均值算法\)。这是一种简单但是高效的局部阈值算法，其核心思想就是把每一个像素的领域平均值作为该位置的阈值。

#### Otsu阈值处理

#### 熵算法

#### 自适应阈值

步骤如下：

1. 对图像进行平滑处理，平滑结果记为$$f_{smooth}(I)$$,其中$$f_{smooth}(I)$$可以是均值平滑，中值平滑或高斯平滑。
2. 自适应阈值矩阵$$Thresh = (1-ratio)*f_{smooth}$$，一般令$$ratio=0.15$$。
3. 利用局部阈值分割进行阈值分割，操作如上面所示。       


[^1]: 《OpenCV算法精解--基于Python与C++》张平


