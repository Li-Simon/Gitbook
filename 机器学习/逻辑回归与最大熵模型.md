# 逻辑回归与最大熵模型
在这里我们以多项逻辑斯蒂回归为例，讨论怎么用最大化似然函数来求解这一类问题。  
假设离散性随机变量Y的取值是(1,2,...,K),输入变量$$\mathbf{X} \in R^n$$  
则，模型如下：  
$$\kern{4 em} P(Y=k|x) = \frac{exp(\mathbf{w_k}\mathbf{x})}{1+\displaystyle \sum_{k=1}^{K-1}exp(\mathbf{w_k}\mathbf{x})}, k=1,2,...,K-1$$  
$$\kern{4 em} P(Y=K|x) = \frac{1}{1+\displaystyle \sum_{k=1}^{K-1}exp(\mathbf{w_k}\mathbf{x})}$$   
这里$$\mathbf{x} \in \mathbf{R^{n+1}};\mathbf{w_k} \in \mathbf{R^{n+1}}$$.  
因此，总的似然函数可以表示为：  
$$\kern{4 em}L(\mathbf{W}) = \displaystyle \prod _{n=1}^NP(Y=Y_n|X=X_n)$$ 
这样，我们需要求的参数是$$W = (\mathbf{w_1},\mathbf{w_2},...,\mathbf{w_{n+1}})$$.

最简单的就是二项逻辑斯蒂回归，在这里K=2:
似然函数可以写成如下简单的形式：  
$$\kern{4 em}L(\mathbf{W}) = \displaystyle \prod _{n=1}^N[\pi(x_i)^{y_i}][1-\pi(x_i)]^{1-y_i}$$  
其中：
$$\kern{4 em}P(Y=1|x) =\pi(x) = \frac{exp(\mathbf{w*x})}{1+exp(\mathbf{w*x})}$$   
$$\kern{4 em} P(Y=0|x) =1-\pi(x)$$   
当$$y_i = 0$$时:  
$$\kern{4 em} [\pi(x_i)^{y_i}][1-\pi(x_i)]^{1-y_i}=1-\pi(x_i)$$ 
当$$y_i = 1$$时:  
$$\kern{4 em} [\pi(x_i)^{y_i}][1-\pi(x_i)]^{1-y_i}=\pi(x_i)$$  
实际上分别是$$y_i = 0$$,$$y_i = 1$$发生的概率。  
一般连乘形式的似然函数容易发生值溢出，故而一般求对数似然函数：  
$$\kern{4 em}L(\mathbf{W}) = \displaystyle \sum _{n=1}^N[y_i\log\pi(x_i) + (1-y_i)\log[1-\pi(x_i)]$$  
$$\kern{7 em} = \displaystyle \sum _{n=1}^N[y_i(w*x_i) + \log(1+exp(w*x_i))$$   
求$$L(\mathbf{W})$$的极大值，得到$$\mathbf{w}$$的估计值。  
问题转化为以对数似然函数为目标函数的最优化问题，一般采用梯度下降法或者拟牛顿法求解。(为啥不使用牛顿法？因为求Hassian矩阵比较麻烦，而拟牛顿法只需要构造Hassian阵就可以了，用迭代法求)



