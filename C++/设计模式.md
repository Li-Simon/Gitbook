# 设计模式

这里主要先介绍简单工厂，工厂方法与抽象工厂，对每种模式要讨论他们的优缺点。

## 简单工厂

简单工厂类：工厂类Factory负责创建所有的产品，通过switch结构来创建不同的产品\(ProductA,ProductB,ProductC...\)。但是每次新加产品必须修改工厂类Factory，在switch中添加新的case。因此，缺点是添加新产品后，整个工厂类必须重新编译。

![](/assets/Simple_Factory.png)  
ProductA,ProductB和ProductC继承自虚拟类Product，Show方法是不同产品的自描述。Factory依赖于ProductA,ProductB,ProductC，Factory根据不同的条件创建不同的Product对象。  
没增加一个产品类，比如ProductD，则需要在enum PRODUCTTYPE中添加TypeD，并且在class Factory中创建产品函数的switch结构中新加一个case。  
需要修改的地方主要是Factory，这里的工厂类的作用是生产不同种类的产品Product。  

```cpp
#include <iostream>
#include <vector>
using namespace std;

typedef enum ProductTypeTag{
        TypeA,
        TypeB,
        TypeC}PRODUCTTYPE;

// Here is the product classclass Product{public:
        virtual void Show() = 0;};

class ProductA : public Product{public:
        void Show()
        {
                cout<<"I'm ProductA"<<endl;
        }};

class ProductB : public Product{public:
        void Show()
        {
                cout<<"I'm ProductB"<<endl;
        }};

class ProductC : public Product{public:
        void Show()
        {
                cout<<"I'm ProductC"<<endl;
        }};

// Here is the Factory class
class Factory{public:
        Product* CreateProduct(PRODUCTTYPE type)
        {
                switch (type)
                {
                case TypeA:
                        return new ProductA();

                case TypeB:
                        return new ProductB();

                case TypeC:
                        return new ProductC();

                default:
                        return NULL;
                }
        }};

int main(int argc, char *argv[]){
        // First, create a factory object
        Factory *ProductFactory = new Factory();
        Product *productObjA = ProductFactory->CreateProduct(TypeA);
        if (productObjA != NULL)
                productObjA->Show();

        Product *productObjB = ProductFactory->CreateProduct(TypeB);
        if (productObjB != NULL)
                productObjB->Show();

        Product *productObjC = ProductFactory->CreateProduct(TypeC);
        if (productObjC != NULL)
                productObjC->Show();

        delete ProductFactory;
        ProductFactory = NULL;

        delete productObjA;
        productObjA = NULL;

        delete productObjB;
        productObjB = NULL;       

        delete productObjC;
        productObjC = NULL;

        return 0;}
```



