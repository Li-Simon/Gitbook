# 第三节 比特币的交易脚本

下面来看下这两段脚本是如何执行，来完成『解题』过程的。

1. 首先执行的是『输入脚本』。因为脚本是从左向右执行的，那么先入栈的是『签名』，随后是『公钥』

   ![](https://pic4.zhimg.com/80/v2-5005f1da39f2ddd348a0230cc6a09794_hd.jpg)
 


 

2. 接着，执行的是『输出脚本』。从左向右执行，第一个指令是OP\_DUP——复制栈顶元素  


 
   ![](https://pic4.zhimg.com/80/v2-3d83410119fb9b4d448877c999c1d9fc_hd.jpg)
 

3. OP\_HASH160——计算栈顶元素Hash，得到pubkeyhash  


 
   ![](https://pic1.zhimg.com/80/v2-64619c2b7321a958bb33afba22db6788_hd.jpg)
 

4. 将『输出脚本』中的『公钥哈希』入栈，为了和前面计算得到的哈希区别，称它为pubkeyhash'  


 
   ![](https://pic1.zhimg.com/80/v2-ab507108d834ca5a911ec20d10079b44_hd.jpg)
 

5. OP\_EQUALVERIFY——检查栈顶前两元素是否相等，如果相等继续执行，否则中断执行，返回失败  


 
   ![](https://pic4.zhimg.com/80/v2-5cfb8a597f8eb781f3cf89cd8ee2b271_hd.jpg)
 

6. OP\_CHECKSIG——使用栈顶前两元素执行签名校验操作，如果相等，返回成功，否则返回失败  


 
   ![](https://pic4.zhimg.com/80/v2-d9a75a3cd3e9f945dfadb7841a88967b_hd.jpg)
 

这样一串指令执行下来，就可以验证这道数学题是否做对了，也就是说验明了想要花费『钱包地址』中比特币的人是否拥有对应的『私钥』。上面的执行过程是可以在[脚本模拟器](https://link.zhihu.com/?target=http%3A//webbtc.com/script)中执行的，能够看到每一步执行的状态，感兴趣的童鞋可以尝试一下。



