# 图像复原

1. 空间滤波
2. 频率滤波
3. 退化函数建模
4. 直接逆滤波
5. 维纳滤波
6. 约束最小二乘法滤波   

图像复原，可以看成是一个二维矩阵受到一些干扰，我们需要把它恢复到未受干扰前的样子。一个类似的问题就是推荐系统中的矩阵填充，我们需要填充矩阵中那些矩阵元为0的元素。  
受干扰的矩阵$$H_d$$是原始矩阵$$H_0$$加上一个微扰矩阵$$H_1$$。我们要尽力恢复$$H_0$$。  
通过空间滤波和频率滤波的方法以及讨论过了，这里不再讨论，我们只讨论其它图像复原的方法。

## 图像退化/复原处理的模型
在这里我们要讨论一种退化与复原模型。就是用退化函数对退化过程建模，在数学上就是退化函数H作用在原始图像f(x,y)上，再加上一些噪声$$\eta (x,y)$$而产生一幅退化的图像$$g(x,y)$$：  
&emsp;&emsp;$$g(x,y) = H[f(x,y)]+\eta (x,y)$$  
我们需要通过退化函数H,噪声$$\eta (x,y)$$以及退化后的图像g(x,y)来得到原始图像的估计$$\hat f(x,y)$$，具体过程如下所示：   
![](/assets/image_degradation_restoration.png)  
通过，我们对退化函数H,噪声$$\eta (x,y)$$知道的越多，则$$\hat f(x,y)$$越接近f(x,y)。  
考虑H是线性的，空间不变(也就是与图像中特定点无关)的过程。那么退化图像在空间域由下面卷积给出：  
&emsp;&emsp;$$g(x,y) = h(x,y)*f(x,y)+\eta (x,y)$$  
在频率域可以通过卷积定理给出：  
&emsp;&emsp;$$G(u,v) = H(u,v)F(u,v)+N(u,v)$$  
大写字母表示的函数表示的是空间域的傅里叶变换。退化函数H(u,v)有时成为光传递函数(OTF)。空间域的h(x,y)被称为点扩散函数(PSF)，其实就是傅里叶光学那一套东西。对于任何种类的输入，让h(x,y)作用于点光源来得到退化的特征。OTF和PSF是傅里叶变换对。    
###逆滤波
当考虑退化函数是线性的，空间不变的函数时，我们在频率域就有：  
&emsp;&emsp;$$G(u,v) = H(u,v)F(u,v)+N(u,v)$$  
退化可以用复原滤波器消除，该滤波器的传递函数是退化h的逆。我们可以从退化图像G根据下面的公式得到未退化之前的原始图像F(原始图像f(x,y)的傅里叶变换)：  
&emsp;&emsp;$$F(u,v) = G(u,v)H^{-1}(u,v)-N(u,v)H^{-1}(u,v)$$     
上面方法也存在两个问题：  
1. $$H^{-1}(u,v)$$接近于0的地方不好处理，一般就是高频的区域。   
2. 没有足够的信息来很好的确定噪声$$N(u,v)$$。  

###维纳滤波
维纳滤波在图像复原公式中合并考虑一些先验信息从而将有关噪声的特性考虑进来。维纳滤波复原给出了对未被噪声污染的原始图像f的最小均方误差$$e^2$$估计$$\hat f$$:  
&emsp;&emsp;$$e^2 = E([f(i,j) - \hat f(i,j)]^2)$$   
E代表取均值。复原图像的估计在频率域中的表达式为：  
&emsp;&emsp;$$\hat F(u,v) = [\frac{1}{H(u,v)}\frac{|H(u,v)|^2}{|H(u,v)|^2+S_{\eta}(u,v)/S_{f}(u,v)}]G(u,v)$$   
$$|H(u,v)|^2 = H^*(u,v)H(u,v)$$   
$$H^*(u,v)$$是$$H(u,v)$$复共轭。  
$$S_{\eta}(u,v) = |N(u,v)|^2$$=噪声的功率谱  
$$S_{f}(u,v) = |F(u,v)|^2$$=未退化图像的功率谱   
$$S_{\eta}(u,v)/S_{f}(u,v)$$被称为信噪功率比。  
我们感兴趣的是两个量：平均噪声功率和平均图像功率，定义为：  
&emsp;&emsp;$$\eta_A=\frac{1}{MN}\displaystyle \sum_{u} \displaystyle \sum_{v} S_{\eta}(u,v)$$  
&emsp;&emsp;$$f_A=\frac{1}{MN}\displaystyle \sum_{u} \displaystyle \sum_{v} S_{f}(u,v)$$  

###约束的最小二乘法(规则化)滤波[^1]   
空间域的复原问题如下：  
&emsp;&emsp;$$g(x,y) = h(x,y)*f(x,y)+\eta (x,y)$$  
表示成向量形式就是：  
&emsp;&emsp;$$\mathbf{g = Hf + \eta}$$  
约束的最小二乘法(规则化)滤波就是求解带约束的优化问题，优化是基于平滑度测量的复原最优化，也就是优化如下函数：  
&emsp;&emsp;$$C=\displaystyle \sum_{x=0}^{M-1} \displaystyle \sum_{y=0}^{N-1}[\nabla^2f(x,y)]^2$$    
而约束条件就是：  
&emsp;&emsp;$$\mathbf{||g - H\hat f||^2  = ||\eta||^2}$$  
$$\hat f$$就是非退化函数的估计。这种方式就是保证复原的函数平滑度最优。求解的问题就是带约束的优化问题，可以参照数值优化那一章里面的带约束的优化问题那一部分。  


[^1]: 《数字图像处理的Matlab实现》Rafael C.Gonzalez 第四章




