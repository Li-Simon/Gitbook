# 数据库--从数据库生成.dbml文件以及.cs文件

# [LINQ之路 9：LINQ to SQL 和 Entity Framework（上）](http://www.cnblogs.com/qixuejia/p/5410658.html)

SqlMetal是跟随VS发布的一个自动工具，可以用来生成数据库的Linq代码。

```csharp
partial class contour
    {
        partial void OnCreated()
        {
            contour_type = 0;
            interval_value = 1.0;
            edge_exclusion = 0;
            flat_exclusion = 0;
            rotation = 0;
            tilt = 0;
            num_intervals = 15;
            display_flag = 0;
            interval_type = 0;
            @override = 1;
            autoscale = 1;

        }

        static public contour Clone(contour from)
        {
            contour ct = new contour()
            {
                contour_type = from.contour_type,
                interval_value = from.interval_value,
                edge_exclusion = from.edge_exclusion,
                flat_exclusion = from.flat_exclusion,
                rotation = from.rotation,
                tilt = from.tilt,
                num_intervals = from.num_intervals,
                display_flag = from.display_flag,
                interval_type = from.interval_type,
                @override = from.@override,
                autoscale = from.autoscale
            };

            return ct;
        }
    }

数据库怎么设计的class.cs中的成员变量必须定义在AllDataTable.designer.cs里面。AllDataTable.designer.cs是怎么自动生成的？
[global::System.Data.Linq.Mapping.TableAttribute(Name="dbo.contour")]
public partial class contour : INotifyPropertyChanging, INotifyPropertyChanged
{
        private static PropertyChangingEventArgs emptyChangingEventArgs = new PropertyChangingEventArgs(String.Empty);

        private int _contour_sid;

        private System.Nullable<short> _contour_type;

        private System.Nullable<double> _interval_value;

        private System.Nullable<float> _edge_exclusion;

        private System.Nullable<float> _flat_exclusion;

        private System.Nullable<short> _rotation;

        private System.Nullable<short> _tilt;

        private short _num_intervals;

        private int _display_flag;

        private short _interval_type;

        private short _override;

        private short _autoscale;

        private EntitySet<md_collection_summary> _md_collection_summaries;
        private EntitySet<recipe_desc> _recipe_descs;
```

# 如何：通过修改 DBML 文件生成自定义代码 {#how-to-generate-customized-code-by-modifying-a-dbml-file}

[你可以从数据库标记语言](https://docs.microsoft.com/zh-cn/dotnet/framework/data/adonet/sql/linq/how-to-generate-customized-code-by-modifying-a-dbml-file) \(.dbml\) 元数据文件生成 Visual Basic 或 C\# 源代码。此方法提供了一个在生成应用程序映射代码前自定义默认 .dbml 文件的机会。这是一项高级功能。

此过程中的步骤如下：

1. 生成 .dbml 文件。

2. 使用编辑器修改此 .dbml 文件。请注意，此 .dbml 文件必须通过LINQ to SQL.dbml 文件的架构定义 \(.xsd\) 文件的验证。有关详细信息，请参阅[LINQ to SQL 中的代码生成](https://docs.microsoft.com/zh-cn/dotnet/framework/data/adonet/sql/linq/code-generation-in-linq-to-sql)。

3. 生成 Visual Basic 或 C\# 源代码。

下面的示例使用 SQLMetal 命令行工具。有关详细信息，请参阅[SqlMetal.exe（代码生成工具）](https://docs.microsoft.com/zh-cn/dotnet/framework/tools/sqlmetal-exe-code-generation-tool)。

## 示例 {#example}

下面的代码从 Northwind 示例数据库生成 .dbml 文件。您可以使用数据库的名称或 .mdf 文件的名称作为数据库元数据的源。

复制

```
sqlmetal /server:myserver /database:northwind /dbml:mymeta.dbml  
sqlmetal /dbml:mymeta.dbml mydbfile.mdf
```

## 示例 {#example-1}

下面的代码从.dbml 文件生成 Visual Basic 或 C\# 源代码文件。

复制

```
sqlmetal /namespace:nwind /code:nwind.vb /language:vb DBMLFile.dbml  
sqlmetal /namespace:nwind /code:nwind.cs /language:csharp DBMLFile.dbml
```

```
PILI-E7480\MIURA
sqlmetal /server:PILI-E7480\MIURA /database:emu /dbml:emu.dbml //从数据库生成dbml文件
sqlmetal /namespace:emu /code:emu.cs /language:csharp emu.dbml //从dbml生成.cs文件
```



