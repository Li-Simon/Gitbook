# 第四章 推荐系统

推荐系统在数学上就是一个超大规模稀疏矩阵的分解与重构问题，推荐实际上就是寻找User-Item矩阵中本该不为0而实际为0的矩阵元。  
对矩阵分块，实现的就是聚类功能，可以有基于Item的聚类，也可以有基于User的聚类，因此，要研究怎么有效的对矩阵进行分块。

推荐系统中的Matrix Factorization\(MF\)或者Dimensionality Reduction，实际上就是数学SVD，因此推荐系统中这些算法也称为SVD模型。

### 矩阵分解

U-I矩阵是一个大的稀疏矩阵，我们需要寻找矩阵的一个低秩分解，实际上就就是一个奇异值分解\(SVD\)。  
$$\kern{8 em} V = UM$$  
评分矩阵$$V \in \mathbb{R}^{n \times m}$$,SVD实际上就是去找到两个矩阵：$$U \in \mathbb{R}^{f \times n}$$，$$M \in \mathbb{R}^{f \times m}$$，其中矩阵U表示 User 和 feature 之间的联系，矩阵V表示 Item 和 feature 之间的联系。$$f \ll m, f \ll n$$。这样就完成了矩阵的分解。实际计算中，我们并不是通过常规的求本征值本征矢的SVD来做分解，而是通过最小二乘加正则约束来实现分解。

### SVD存在的问题

会出现矩阵元为负数的非现实情况。因此有了非负矩阵分解。

### 一些需要处理的问题

1. 怎么有效的对矩阵进行低秩分解？能否针对不同场景总结出不同的分解方法？
2. 怎么设定求解的损失函数？是欧氏距离而是L1距离？这得回到我们的业务要求，如果U-I矩阵的矩阵元就是消费的金额，是否损失函数中曼哈顿距离比欧氏距离更好？  
3. 正则项怎么加？
4. 隐变量个数怎么选择？
5. 怎么加**显式反馈数据**（explicit feedbacks）和**隐式反馈**（implicit feedbacks）数据？
6. 怎么设置损失函数？损失函数应该包括哪些项目？
7. 怎么有效的为矩阵分块？矩阵分块实际上实现的就是聚类。[^1]



[^1]: 牛温佳 《用户网络行为画像》

